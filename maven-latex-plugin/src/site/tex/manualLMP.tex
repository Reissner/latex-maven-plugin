\RequirePackage[l2tabu, orthodox]{nag}
% blabla 
\PassOptionsToPackage{autostyle}{csquotes}
%\PassOptionsToPackage{dvipdfmx}{xcolor} %or dvipdfm 
%\PassOptionsToPackage{dvipdfmx}{graphicx} %or dvipdfm 
%\RequirePackage{lmodern} % does not work with htlatex
%\directlua{pdf.setminorversion(7)}
%\DocumentMetadata{pdfversion=1.7}%, lang=en-US}
\documentclass[a4paper,12pt,german,english]{book}
\newif\iflatextortf% false for latex but set true for latex2rtf internally 

%\includeonly{manualC3usage}

% for buildParams to check empty: \ifdefempty
\usepackage{etoolbox}
% for buildParams: \verbdef 
\usepackage{newverbs}

\usepackage[depythontex]{pythontex}% TBD: check whether appropriate 

% before \input{header.tex} because header.tex contains a patch for listings 
\usepackage{listings}
\usepackage{iftex}% This is a hack: is loaded later also in header.tex
% it is needed for htlatex because there is no htlualatex. 
% Even if there were, we had to change latex compiler separately for pdf and html. 
% The solution is to use make4ht and to pass the latex compiler as an argument.  
% 
\iftutex%
\usepackage{luamplib}% works with lualatex only maybe with magic comment 
\else
\fi
\input{header.tex}
\IfPackageLoadedTF{tex4ht}{
}{
  % TBD: clarify: 
  % whereas \makeindex does not cause a warning, /makeglossaries does. 
  % One has to decide whether each document must have a bibliography, an index and a glossary. 
  % I think neither. 
  % so, shall be moved out of the general header. 
  % \usepackage{splitidx}%[split]
  % %  \usepackage{makeidx}
  % %  \usepackage{showidx}
  % \makeindex
  % % TBD: eliminate; loads amsmath!!! 
  \usepackage[toc, acronym, nohypertypes={acronym},style=tree]{glossaries}%nomain, 
  % , xindy or even [xindy={language=english,codepage=utf8}]
  % mainly for index and glossaries 
  \makeglossaries%
}
\setMinorVersionPdf{7}% because of gnuplot file only 
% how to number the glossary in the toc? seemingly a gap in tocbibind 
%\usepackage[nottoc, numindex, numbib]{tocbibind}
\input{headerGrp.tex}
\input{headerManual.tex}
\input{buildParams.tex}
\input{headerSuppressMetaPDF.tex}

\hypersetup{
  pdfinfo={
    Author      ={Ernst Reissner},
    Title       ={Maven plugin and ant-task to process latex},
    Subject     ={latex plugin for maven and latex task for ant},
    Keywords    ={svg;png;metapost;PDF;LaTeX;maven;ant}
  }
}


\IfPackageLoadedTF{tex4ht}{%
  % no glossaries and no index with tex4ht 
  % Syntax: \gls[⟨options ⟩]{⟨label ⟩}[⟨insert text ⟩] 
  % cannot be covered with this... 
  % needed e.g. \NewDocumentCommand{\gls}{O{}mO{}}{#2}
  \newcommand{\gls}[1]{#1}
  \newcommand{\Gls}[1]{#1}
  \newcommand{\GLS}[1]{#1}
  \newcommand{\glspl}[1]{#1}
  \newcommand{\Glspl}[1]{#1}
  \newcommand{\GLSpl}[1]{#1}
  % not complete, what about \glsfirst and family
  % interesting is \glsdesc
  % see glossaries manual around page 140 
  \renewcommand{\index}[1]{}
  % why no \sindex? because based on \index? 
  \newcommand{\newindex}[1][]{}
}{%
\setacronymstyle{long-short}%{footnote}%

\newglossaryentry{gls:le}{name={\LaTeX{} engine},description={%
A compiler for \LaTeX{} files 
}}

\newglossaryentry{gls:lmf}{name={\LaTeX{} main file},description={%
A \LaTeX{} file intended to be compiled by a \gls{gls:le}. 
}}


\setacronymstyle{short-long}%{footnote}%{long-short}%
% file formats 
\newacronym{pdf}{PDF}{Portable Document Format}
\newacronym{dvi}{DVI}{DeVice Independent; 
traditional output format of \LaTeX{} engines, today widely replaced by PDF}
\newacronym{xdv}{XDV}{eXtended Device Independent; 
an extension of the traditional output format \gls{dvi} of \LaTeX{} engines, 
today widely replaced by PDF}
\newacronym{eps}{EPS}{Encapsulated PostScript}
\newacronym{tex}{TEX}{\TeX{} the format, which may also be \LaTeX}
\newacronym{html}{HTML}{HyperText Markup Language}
\newacronym{xhtml}{XHTML}{eXtensible HyperText Markup Language}
\newacronym{odt}{ODT}{Open Document Text}
\newacronym{doc}{DOC}{outdated document format for MS Word }
\newacronym{docx}{DOCX}{current document format for MS Word }
\newacronym{sgml}{SGML}{Standard Generalized Markup Language }
\newacronym{xml}{XML}{eXtensible Markup Language }
\newacronym{ptx}{PTX}{pdf/postscript \TeX{} format; home-brewed }% home-brewed 

\newacronym{fig}{FIG}{native file format for xfig }
\newacronym{gp}{GP}{GnuPlot file format}
\newacronym{png}{PNG}{Portable Network Graphics}
\newacronym{jpg}{JPG}{Graphics format developed by the Joint Photographic Experts Group }
\newacronym{gif}{GIF}{Graphics Interchange Format, allows also animations }
\newacronym{bb}{BB}{Bounding Box, created by ebb }
\newacronym{xbb}{XBB}{Bounding Box, created by ebb with the option x. 
In addition to BB-files contains a high resolution bounding box }
\newacronym{svg}{SVG}{Scalable Vector Graphics}
% latex file endings 
\newacronym{toc}{TOC}{Table Of Contents: input and output format of \LaTeX{} engines}
\newacronym{lof}{LOF}{List Of Figures: input and output format of \LaTeX{} engines}
\newacronym{lot}{LOT}{List Of Tables: input and input and output format of \LaTeX{} engines}
\newacronym{lol}{LOL}{List Of Listings: input and output format of \LaTeX{} engines 
if used with package \texttt{listings}}
\newacronym{bcf}{BCF}{bibliography content file (?): generated by \LaTeX{} engines 
if used with package \texttt{biblatex}}
\newacronym{out}{OUT}{contains bookmarks: input and output format of \LaTeX{} engines 
if used with package \texttt{hyperref}, file ending seems naive}
\newacronym{ist}{IST}{(make-)Index Style File: output format of \LaTeX{} engines % chktex 36
if used with package \texttt{glossaries} configured for \tool{makeindex} }
\newacronym{xdy}{XDY}{index style file for \tool{xindy}: output format of \LaTeX{} engines 
if used with package \texttt{glossaries} configured for \tool{xindy} }


\newacronym{log}{LOG}{logging file: for \LaTeX{} engines and \tool{mpost}}
\newacronym{aux}{AUX}{auxiliary file: input and output file for \LaTeX{} engines; 
read also e.g\@. by \tool{bibtex}}
\newacronym{fls}{FLS}{FiLeS dependencies: list of files the according tex file depends on; 
output format of \LaTeX{} engines if used with option \texttt{-recorder}}
\newacronym{synctex.gz}{synctex.gz}{gnu-zipped synchronization files 
relating TEX files and their according PDF files: 
output format of \LaTeX{} engines if used with option \texttt{-synchtex=1}}

% files in conjunction with bibliographies
\newacronym{bib}{BIB}{BIBliography file: 
In particular input file for the \tool{bibtex} tool}
\newacronym{bbl}{BBL}{bibliography for a latex document in latex format: 
written by the \tool{bibtex} tool and read by \LaTeX{} processors}
\newacronym{bst}{BST}{Bibliography Style File read by the \tool{bibtex} tool}

% files in conjunction with indices 
\newacronym{idx}{IDX}{InDeX file containing unsorted and multiple index entries; 
output format of \LaTeX{} engines with package \tool{makeindex} or similar}
\newacronym{ind}{IND}{%
INDex file containing sorted, unified and formatted index entries, 
output format of \tool{makeindex} and \tool{xindy}}

% files in conjunction with glossaries 
\newacronym{glo}{GLO}{%
GLOssary file containing unsorted and multiple glossary entries; 
output format of \LaTeX{} engines with package \tool{makeglossaries}}
\newacronym{glg}{GLG}{%
\tool{makeglossaries} log file }
\newacronym{gls}{GLS}{%
glossary file containing sorted, unified and formatted glossary entries;
output format of the \tool{makeglossaries} tool read by \LaTeX{} engines}
% TBD: one could add is and xdy files. 

% files in conjunction with pythontex
\newacronym{pytxcode}{PYTXCODE}{%
Code file consisting mainly of code snippets from the TEX file; 
output format of \LaTeX{} engines with package \tool{pythontex}}
\newacronym{depytx}{DEPYTXC}{%
File containing information to replace code snippets in the TEX file 
by the result of their evaluation;  
output format of \LaTeX{} engines with package \tool{pythontex} 
if loaded with option \tool{depythontex}
}
\newacronym{plg}{PLG}{%
\tool{pythontex} log file: home-brewed since the original application does not write log files 
}
\newacronym{dplg}{DPLG}{%
\tool{depythontex} log file: home-brewed since the original application does not write log files 
}

\newacronym{mp}{MP}{MetaPost: input format for the graphic program \tool{mpost}}
\newacronym{ps}{PS}{PostScript: 
programming language for printers and printable file format; 
today mostly replaced by PDF}
\newacronym{mps}{MPS}{metapost's postscript like output including text}
\newacronym{mpx}{MPX}{metapost TEX output: texts }


\newindex[General Index]{idx}
\newindex[LaTeX Packages]{pkg}
\newindex[LaTeX Commands]{cmd}
}

% \newglossaryentry{latex}{name={latex},description={%
% First a file format based on \TeX with ending \gls{tex}, 
% and secondly a document preparation system 
% converting sources in the latex-format into a presentation format, 
% preferrably into pdf-output. 
% Historically, output was in \gls{dvi}-format 
% which is still used by htlatex as an intermediate format 
% to produce \gls{html} resp.~\gls{xhtml} and \gls{odt} output. 
% %
% Besides latex compilers, doing the proper conversion, 
% this comprises many auxiliary programs, 
% e.g. for bibliography but also to create graphics. 
% }}
% \newglossaryentry{latexCMP}{name={latex compiler},description={%
% Core part of the document preparation system \gls{latex}. 
% }}







% \newindex[General Index]{idx}
% \newindex[LaTeX Packages]{pkg}

% does not work 
%\setindexpreamble[pkg]{This index comprises all the latex packages used. }

\title{Manual for the \artifactId{} \protect\\
  and for an according ant-task \protect\\
Version \strippedVersionID}
\author{Ernst Reissner (rei3ner@arcor.de)}
\date{\today}%{\versionDate}


% seems to have a problem with pythontexW maybe clean before
%\includeonly{manualC4graphics}

\begin{document}
\maketitle

\tableofcontents
\listoffigures
\listoftables
\lstlistoflistings%


\include{manualC01intro}
\include{manualC02inst}
\include{manualC03usage}
\include{manualC04graphics}
\include{manualC05procMain}
\include{manualC06paramsSettings}
\include{manualC07ExcLogging}
\include{manualC08Gaps}
\include{manualC09Bugs}
\include{manualC10prefUsage}


\bibliographystyle{alpha}
\bibliography{lit,litLMPpub,litTools}

\IfPackageLoadedTF{tex4ht}{%
  % no index and no glossaries with tex4ht 
}{
%\chapter{Indices}
  \printindex[idx]
  \printindex[pkg]
  \printindex[cmd]
  \printglossaries%
}


%  "-src-specials -shell-escape -recorder" 
\end{document}

